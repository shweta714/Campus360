<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Settings - Campus360</title>
  <link rel="stylesheet" href="student-dashboard.css">
  <script src="theme.js" defer></script>
</head>
<body>
  <!-- App Sidebar (shared) -->
  <aside class="app-sidebar" id="appSidebar" aria-label="Main navigation">
    <nav class="sidebar-nav">
      <ul>
        <li class="sidebar-item" data-target="student-dashboard.html" title="Home">
          <button class="sidebar-btn" data-href="student-dashboard.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M3 10.5L12 4l9 6.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M5 10.5v7a1 1 0 0 0 1 1h3v-5h6v5h3a1 1 0 0 0 1-1v-7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </li>
        <li class="sidebar-item" data-target="profile.html" title="Profile Overview">
          <button class="sidebar-btn" data-href="profile.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M12 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M4 20a8 8 0 0 1 16 0" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </li>
        <li class="sidebar-item" data-target="exam-panel.html" title="Exam Panel">
          <button class="sidebar-btn" data-href="exam-panel.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M3 6.5A2.5 2.5 0 0 1 5.5 4H20" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M21 4v14a2 2 0 0 1-2 2H6.5A2.5 2.5 0 0 1 4 17.5V4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M8 14h8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </li>
        <li class="sidebar-item" data-target="courses.html" title="Resources">
          <button class="sidebar-btn" data-href="courses.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M4 6.5A2.5 2.5 0 0 1 6.5 4H20" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </li>
        <li class="sidebar-item" data-target="settings.html" title="Settings">
          <button class="sidebar-btn" data-href="settings.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M19.4 15a1.8 1.8 0 0 0 .3 2l.1.1a1 1 0 0 1-1.4 1.4l-.1-.1a1.8 1.8 0 0 0-2 .3l-.2.2a1 1 0 0 1-1.4 0l-.2-.2a1.8 1.8 0 0 0-2-.3l-.2.1a1 1 0 0 1-1-.2l-.1-.1a1.8 1.8 0 0 0-.3-2l-.1-.1a1 1 0 0 1 0-1.4l.1-.1a1.8 1.8 0 0 0 .3-2l-.1-.2a1 1 0 0 1 1.1-1.4l.2.1a1.8 1.8 0 0 0 2-.3l.2-.2a1 1 0 0 1 1.4 0l.2.2a1.8 1.8 0 0 0 2 .3l.2-.1a1 1 0 0 1 1 .2l.1.1a1.8 1.8 0 0 0 .3 2l.1.1a1 1 0 0 1 0 1.4l-.1.1z" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </li>
      </ul>
    </nav>
  </aside>

  <!-- top navbar removed in favor of sidebar navigation -->

  <main style="max-width:900px;margin:80px auto 40px;padding:20px;">
    <section class="settings-card">
      <div class="settings-bubbles" id="settingsBubbles"></div>
      <h1>Settings</h1>
      <div class="settings-grid">
        <div class="settings-item">
          <h3>Theme</h3>
          <p>Choose the color theme.</p>
          <div class="btn-group" style="margin-top:10px;">
            <button class="seg-btn" data-value="light" id="themeLight">Light</button>
            <button class="seg-btn active" data-value="dark" id="themeDark">Dark</button>
          </div>
        </div>

        <div class="settings-item">
          <h3>Notifications</h3>
          <p>Manage notifications.</p>
          <div class="btn-group" style="margin-top:10px;">
            <button class="seg-btn" data-value="off" id="notifyOff">Off</button>
            <button class="seg-btn active" data-value="on" id="notifyOn">On</button>
          </div>
        </div>

        <div class="settings-item">
          <h3>Account</h3>
          <p>Danger zone: Removes saved profile locally and signs you out.</p>
          <div style="margin-top:8px;display:flex;gap:8px;align-items:center;">
            <button id="resetProfile" class="btn">Reset Profile</button>
            <button id="logoutBtn" class="btn danger">Logout</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    const PREF_KEY = 'campus360_prefs';
    function loadPrefs(){
      const raw = localStorage.getItem(PREF_KEY);
      const prefs = raw ? JSON.parse(raw) : { theme:'dark', notify:true };
      // set buttons
      document.getElementById(prefs.theme === 'dark' ? 'themeDark' : 'themeLight').classList.add('active');
      document.getElementById(prefs.notify ? 'notifyOn' : 'notifyOff').classList.add('active');
      try{ if(window.setTheme) window.setTheme(prefs.theme); else applyTheme(prefs.theme === 'dark'); }catch(e){ applyTheme(prefs.theme === 'dark'); }
    }
    function savePrefs(themeVal, notifyVal){
      const prefs = { theme: themeVal, notify: notifyVal };
      localStorage.setItem(PREF_KEY, JSON.stringify(prefs));
      try{ if(window.setTheme) window.setTheme(themeVal); else applyTheme(themeVal === 'dark'); }catch(e){ applyTheme(themeVal === 'dark'); }
    }
    function applyTheme(dark){
      if(dark) document.body.classList.add('dark-theme'); else document.body.classList.remove('dark-theme');
    }
    document.addEventListener('DOMContentLoaded', function(){
      loadPrefs();
      // theme buttons
      document.getElementById('themeDark').addEventListener('click', function(){
        document.getElementById('themeDark').classList.add('active');
        document.getElementById('themeLight').classList.remove('active');
        savePrefs('dark', document.getElementById('notifyOn').classList.contains('active'));
      });
      document.getElementById('themeLight').addEventListener('click', function(){
        document.getElementById('themeLight').classList.add('active');
        document.getElementById('themeDark').classList.remove('active');
        savePrefs('light', document.getElementById('notifyOn').classList.contains('active'));
      });
      // notify buttons
      document.getElementById('notifyOn').addEventListener('click', function(){
        document.getElementById('notifyOn').classList.add('active');
        document.getElementById('notifyOff').classList.remove('active');
        const themeVal = document.getElementById('themeDark').classList.contains('active') ? 'dark' : 'light';
        savePrefs(themeVal, true);
      });
      document.getElementById('notifyOff').addEventListener('click', function(){
        document.getElementById('notifyOff').classList.add('active');
        document.getElementById('notifyOn').classList.remove('active');
        const themeVal = document.getElementById('themeDark').classList.contains('active') ? 'dark' : 'light';
        savePrefs(themeVal, false);
      });

      document.getElementById('resetProfile').addEventListener('click', function(){
        if(!confirm('Remove stored profile data? This cannot be undone locally.')) return;
        localStorage.removeItem('campus360_profile');
        alert('Local profile reset.');
      });
      document.getElementById('logoutBtn').addEventListener('click', function(){
        try{ sessionStorage.clear(); localStorage.removeItem('authToken'); } catch(e){}
        window.location.href = 'index.html';
      });
    });
  </script>
    <script>
      (function initSidebarSettings(){
        const sidebar = document.getElementById('appSidebar'); if(!sidebar) return;
        const items = sidebar.querySelectorAll('.sidebar-item');
        const current = window.location.pathname.split('/').pop() || 'settings.html';
        items.forEach(li => {
          const target = li.getAttribute('data-target');
          if (target === current) li.classList.add('active');
          const btn = li.querySelector('.sidebar-btn');
          if (btn) {
            btn.addEventListener('click', function () { items.forEach(x => x.classList.remove('active')); li.classList.add('active'); const href = btn.getAttribute('data-href'); if (href) window.location.href = href; });
            btn.addEventListener('keydown', function (e) { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); btn.click(); } });
          }
        });
      })();
    </script>
</body>
</html>
